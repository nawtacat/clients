<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="icon" type="image/jpg" href="https://pha.am/rounded_favicon.png">
    <link rel="stylesheet" href="/thestyle.css">
    
    <script type="module">
        // Import Firebase Modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAbnPpcIt88B0jIAoLUdC71zmQDvR_fdu8",
            authDomain: "physmathacademy-722b3.firebaseapp.com",
            projectId: "physmathacademy-722b3",
            storageBucket: "physmathacademy-722b3.appspot.com",
            messagingSenderId: "1093649922622",
            appId: "1:1093649922622:web:35b1bf4d2364bcf745f587",
            measurementId: "G-CGVKXTXJLB"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // üîí Ensure User is Logged In
        onAuthStateChanged(auth, async (user) => {
            if (!user) {
                window.location.href = "/login"; // Redirect to login if not authenticated
                return;
            }

            // üèÜ Get Profile Data from Firestore
            const userDoc = await getDoc(doc(db, "users", user.uid));

            if (userDoc.exists()) {
                const userData = userDoc.data();
                document.getElementById("user-name").textContent = `‘≤’°÷Ä’´ ’£’°’¨’∏÷Ç’Ω’ø, ${userData.name}`;
                document.getElementById("user-id").textContent = userData.id || "N/A";
            } else {
                console.log("No user data found");
            }
        });

        // üö™ Logout Function
        function logout() {
            signOut(auth).then(() => {
                window.location.href = "/login"; // Redirect to login after logout
            }).catch((error) => {
                console.error("Logout failed:", error);
            });
        }

        window.logout = logout;
    </script>
</head>
<body>
    <div class="container">
        <img src="https://pha.am/rounded_favicon.png" alt="PhA Logo" class="profile-image">
        
        <div class="id-container">
            <h2 id="user-id">Loading...</h2>
            <img src="https://pha.am/cloud.png" alt="Install App" class="install-icon" id="installIcon">
        </div>

        <p class="description" id="user-name">‘≤’°÷Ä’´ ’£’°’¨’∏÷Ç’Ω’ø...</p>
        
        <a class="buttonO" href="https://pha.am/homework/">‘π’•’Ω’ø’°’µ’´’∂ ’°’∑’≠’°’ø’°’∂÷Ñ</a>
        <a class="button" href="https://meet.google.com/uko-nxgb-nuf">’Ñ’´’°’∂’°’¨ ’§’°’Ω’´’∂</a>
        <a class="button" href="https://calendar.google.com/calendar/embed?src=441cbb27cfab02a3190e10174dcfeab17f03d8a67da61df498b57918a56f0270%40group.calendar.google.com&ctz=Asia%2FYerevan">’Ä’°’≥’°’≠’∏÷Ç’©’µ’∏÷Ç’∂</a>
        <a class="button" href="#" onclick="checkSubscription()">‘≤’°’™’°’∂’∏÷Ä’§’°’£÷Ä’∏÷Ç’©’µ’∏÷Ç’∂</a>
        <a class="button" href="https://invite.viber.com/?g2=AQAYUchWgqzljlQ7yDrGFe13X2ZDWJdjYJJtUvzMw9UWb08m7dWDP2P%2BFcabN3fX">’Ä’°’¥’°’µ’∂÷Ñ</a>
        <button class="button logout-btn" onclick="logout()">‘¥’∏÷Ç÷Ä’Ω ’£’°’¨</button>
    </div>

    <script>
        function checkSubscription() {
            alert('’Å’•÷Ä ’¢’°’™’°’∂’∏÷Ä’§’°’£÷Ä’∏÷Ç’©’µ’∏÷Ç’∂’® ‘±‘ø’è‘ª’é ’ß ’¥’´’∂’π÷á 01.03.2025');
        }
    </script>
</body>
</html>

